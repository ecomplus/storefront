<div class="collection-shelf container">
  <%
  if (opt.collection_id) {
    const res = await _.ecomClient.store({
      url: `/collections/${opt.collection_id}.json`
    })
    const collection = res.data
    let items = []
    if (Array.isArray(collection.products) && collection.products.length) {
      const search = new _.EcomSearch()
      await search.setProductIds(collection.products).fetch()
      items = search.getItems()
    }
    const { title, link } = opt

    %>
    <%- await include('/@/sections/inc/products-carousel', {
      _, opt: { items, collection, title, link }
    }) %>
    <%
  } else {
    %>
    <%- await include('/@/sections/inc/products-carousel', {
      _, opt: { items: _.items }
    }) %>
    <%
  }
  %>
</div>
