<%- await include('/@/meta') %>

<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js').then(registration => {
    console.log('SW registered: ', registration)
  }).catch(registrationError => {
    console.log('SW registration failed: ', registrationError)
  })
}
</script>
<link rel="stylesheet" type="text/css" href="/storefront.css">

<%
// inject custom code
const customCode = _.cms('code') || {}

if (customCode.css) {
  %>
  <style>
    <%- customCode.css %>
  </style>
  <%
}

%>
<%
// redirect to maintanance page
const maintanance = _.cms('maintanance') || {}

if (maintanance.activate && maintanance.link) { 
  %>
    <script>
        if (location.href !== '<%- maintanance.link %>' && location.hash !== '#sb') {
          location.href = '<%- maintanance.link %>';
        } else if(location.href !== '<%- maintanance.link %>' && location.hash === '#sb') {
            //do nothing
        }
    </script>
<% } %>

<%- customCode.html_head %>
